# rs-langc: 类 Rust 语言编译器（编译原理课程项目）

A complete Rust-like programming language compiler implemented for Compiler Principles course, supporting lexical analysis, syntax analysis, semantic checking, intermediate code generation, and MIPS assembly code generation.

## 🌟 项目概述

本项目是基于编译原理理论实现的**类 Rust 语言编译器**，涵盖编译器前端到后端的全流程开发。项目分为三个核心阶段，从词法语法分析入手，逐步实现语义检查、中间代码生成，最终输出可在 MARS 模拟器中执行的 MIPS32 汇编代码，完整复现了现代编译器的核心工作流程。

设计目标：

- 遵循类 Rust 语言的语法风格与语义规则，支持变量声明、函数调用、控制结构等核心特性
- 采用模块化架构，实现编译流程各阶段的解耦与协同
- 保证生成代码的正确性与高效性，严格遵循 MIPS 调用约定与指令集规范

## 🚀 核心功能

### 1. 词法与语法分析（前端基础）

- 词法分析：基于有限状态机实现按需 Token 生成，支持识别关键字、标识符、常量、运算符等词法单元
- 语法分析：采用 LR (1) 分析法构建分析表，通过移进 - 归约操作生成语法树，支持 if/else、循环、函数定义等复杂结构
- 可视化支持：通过 Tkinter+Graphviz 实现语法树可视化与交互界面，支持单步调试与分析过程展示

### 2. 语义分析与中间代码生成

- 静态语义检查：实现类型检查、作用域管理、符号表维护，支持数组、元组、引用等类型的语义验证
- 错误检测：精准识别未声明变量、类型不匹配、数组越界、不可变变量二次赋值等语义错误
- 中间代码生成：采用语法制导翻译技术，将语法树转换为四元式中间表示，支持控制流回填与临时变量管理

### 3. 目标代码生成（后端实现）

- 基本块划分与控制流分析：将四元式序列划分为单一入口 / 出口的基本块，构建控制流图 (CFG)
- 寄存器分配：基于线性扫描算法优化寄存器使用，支持变量溢出与栈帧管理
- MIPS 汇编生成：通过模板匹配实现指令选择，生成符合 MIPS32 标准的汇编代码，支持函数调用约定与栈帧布局

## 🛠️ 技术栈

- 开发语言：Python（核心逻辑实现）
- 语法分析：LR (1) 分析法、自动机理论
- 可视化工具：Tkinter（交互界面）、Graphviz（语法树绘制）
- 目标架构：MIPS32（支持 MARS 模拟器运行）

## 📋 支持的语言特性

### 数据类型

- 基础类型：i32 整数类型
- 复合类型：定长数组（`[i32; 3]`）、元组（`(i32, bool)`）
- 引用类型：不可变引用（`&T`）、可变引用（`&mut T`）

### 程序结构

- 变量声明：支持可变（`mut`）与不可变变量声明，支持类型标注与初始化赋值
- 函数定义：支持参数列表、返回值类型声明、函数调用与嵌套调用
- 控制结构：if-else 分支、while 循环、for 循环（迭代结构）、loop 循环
- 循环控制：支持`break`、`continue`语句，支持循环表达式返回值

## 📊 实验验证

项目通过多组测试用例验证各模块功能正确性：

- 语法正确性：支持复杂表达式求值、嵌套函数调用、多层条件分支等场景
- 语义准确性：能精准捕获 10 + 类语义错误并给出定位提示
- 代码有效性：生成的 MIPS 汇编可在 MARS 模拟器中正确执行，输出结果与预期一致

## ✨ 项目亮点

- 全流程实现：覆盖编译器前端到后端的完整链路，理解编译原理核心理论
- 工程化设计：模块化架构 + 清晰接口定义，便于后续扩展与优化
- 可视化调试：提供语法树与分析过程可视化，降低编译原理学习门槛
- 实用化输出：生成可执行的 MIPS 汇编代码，而非单纯的理论验证

## 📌 备注

本项目为编译原理课程设计成果，旨在实践编译器核心技术，并非工业级编译器实现。如需扩展功能，可考虑添加代码优化（常量折叠、死代码消除）、更多目标架构支持或与 LLVM 后端集成。
